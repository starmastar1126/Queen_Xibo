{#
/*
 * Spring Signage Ltd - http://www.springsignage.com
 * Copyright (C) 2015 Spring Signage Ltd
 * (${FILE_NAME})
 */
// Augment settings with templates
        $this->loadTemplates();

        $formFields = array();
        $formFields[] = Form::AddCombo(
            'sourceid',
            __('Source Type'),
            NULL,
            array(array('sourceid' => '1', 'source' => __('Feed')), array('sourceid' => '2', 'source' => __('DataSet'))),
            'sourceid',
            'source',
            __('The source for this Ticker'),
            's');

        $formFields[] = Form::AddText('uri', __('Feed URL'), NULL,
            __('The Link for the RSS feed'), 'f', '', 'feed-fields');

        $datasets = $this->getUser()->DataSetList();
        array_unshift($datasets, array('datasetid' => '0', 'dataset' => 'None'));
        Theme::Set('dataset_field_list', $datasets);

        $formFields[] = Form::AddCombo(
            'datasetid',
            __('DataSet'),
            NULL,
            $datasets,
            'datasetid',
            'dataset',
            __('Please select the DataSet to use as a source of data for this ticker.'),
            'd', 'dataset-fields');

        $formFields[] = Form::AddNumber('duration', __('Duration'), NULL,
            __('The duration in seconds this should be displayed'), 'd', 'required');

        Theme::Set('form_fields', $formFields);

        // Field dependencies
        $sourceFieldDepencies_1 = array(
            '.feed-fields' => array('display' => 'block'),
            '.dataset-fields' => array('display' => 'none'),
        );

        $sourceFieldDepencies_2 = array(
            '.feed-fields' => array('display' => 'none'),
            '.dataset-fields' => array('display' => 'block'),
        );

        $response->AddFieldAction('sourceid', 'init', 1, $sourceFieldDepencies_1);
        $response->AddFieldAction('sourceid', 'change', 1, $sourceFieldDepencies_1);
        $response->AddFieldAction('sourceid', 'init', 2, $sourceFieldDepencies_2);
        $response->AddFieldAction('sourceid', 'change', 2, $sourceFieldDepencies_2);

        // Return
        $response->html = Theme::RenderReturn('form_render');
        $this->configureFormButtons($response);
        $response->dialogTitle = __('Add New Ticker');
#}

{% extends "form-base.twig" %}
{% import "forms.twig" as forms %}

{% block formTitle %}
    {% trans "Edit Ticker" %}
{% endblock %}

{% block formButtons %}
    {% trans "Help" %}, XiboHelpRender("{{ help }}")
    {% trans "Cancel" %}, XiboDialogClose()
    {% trans "Save" %}, $("#tickerAddForm").submit()
{% endblock %}

{% block callBack %}forecastIoFormSetup{% endblock %}

{% block formHtml %}
    <div class="row">
        <div class="col-md-12">
            <form id="tickerAddForm" class="XiboForm form-horizontal" method="post" action="{{ urlFor("module.widget.add", {type: module.widget.type, id: playlist.playlistId}) }}">
                        {% set title %}{% trans "Source Type" %}{% endset %}
                        {% set helpText %}{% trans "The source for this Ticker" %}{% endset %}
                        {% set feed %}{% trans "Feed" %}{% endset %}
                        {% set dataSet %}{% trans "DataSet" %}{% endset %}
                        {% set options = [
                        { sourceid: 1, source: yes },
                        { sourceid: 0, source: no }
                        ] %}
                        {{ forms.dropdown("sourceId", "single", title, "", options, "sourceid", "source", helpText) }}
                        
                        {% set title%}{% trans "Feed URL"%{% endset %}}
                        {% set helpText %}{% trans "The Link for the RSS feed" %}{% endset %}
                        {{ forms.text("uri", title, "", helpText, "", "", "feed-fields")}}
                        
                        {# not sure if fine #}
                        {% set title %}{% trans "DataSet" %}{% endset %}
                        {% set helpText %}{% trans "Please select the DataSet to use as a source of data for this ticker." %}{% endset %}
                        {{ forms.dropdown("datasetId", "single", title, "", datasets, "datasetid", "dataset", helpText, "", "dataset-fields") }}

                        {{ forms.number("duration", "Duration", "", "The duration in seconds this should be displayed", "", "required") }}

                        {# dependencies #}
            </form>
        </div>
    </div>
{% endblock %}